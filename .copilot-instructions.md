# Perplexity SPA Reverse Engineering — Copilot Instructions

**Project**: pplx-spa-assets-knowledge
**Current Phase**: Spec enrichment & analysis toolkit  
**Status**: Ready for expansion

---

## Quick Context

We've extracted & analyzed Perplexity.ai SPA from HAR capture:
- **404 REST endpoints** (across 53 categories)
- **397 app JS modules** (gzipped source codes stored)
- **Full spec**: `perplexity_spa_full_spec.json` (~1.9 MB, gzip: ~1.2 MB)
- **Analysis tools**: `spec_analyzer.py` + detailed toolkit guide

---

## What's Ready Now

### 1. **Full Spec Contract (JSON Schema)**
File: `perplexity_spa_full_spec.json` with structure:
```json
{
  "metadata": { /* extraction info */ },
  "endpoints": { 
    "rest": [ ...404 paths... ],
    "rest_by_category": { "finance": [...], "sports": [...], ... },
    "sse": [ ...streaming... ]
  },
  "assets": { "js_modules": [...], "css": [...], ... },
  "requests": { "api_calls": [...observed from HAR...] },
  "source_codes": { "filename": "base64(gzip(js))", ... },
  "source_codes_meta": { "filename": { metadata }, ... },
  "analysis": { "react_hooks": [...], "api_functions": [...] }
}
```

### 2. **Analysis Tools**
- **`spec_analyzer.py`** — unified CLI:
  ```bash
  python spec_analyzer.py analyze-endpoint rest/finance/earnings
  python spec_analyzer.py feature-map --output features.json
  python spec_analyzer.py openapi --output api.json
  python spec_analyzer.py diff old.json new.json --output delta.json
  ```

### 3. **Detailed Toolkit Guide**
File: `perplexity_spec_toolkit.md` with full source code

---

## Next Steps (Priorities)

### Phase 2A: Request/Response Schemas
**Goal**: Auto-extract query & body parameter patterns

### Phase 2B: Component → Hook → API Linkage  
**Goal**: Build dependency graph

### Phase 2C: Feature Flags & Experiments
**Goal**: Detect A/B test flags in code

### Phase 2D: Real-time APIs (SSE/WebSocket)
**Goal**: Map streaming endpoints

---

## How to Continue

See `ROADMAP.md` for details.